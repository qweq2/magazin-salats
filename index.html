<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style5.css" />
    <title>Document</title>
    <script
      src="https://kit.fontawesome.com/7ce3ef6933.js"
      crossorigin="anonymous"
    ></script>
    <!-- <script src="magazin-1.js"></script> -->
  </head>
  <body>
    <script src="magazin-1.js"></script>

    <div class="menu">
      <div class="about-us">
        <a href="">О нас</a>
        <div class="name"><p>Салаты у Никиты</p></div>
        <div class="number">+7 (918)-740-0517</div>
      </div>
      <div class="glavnoe">
        <div>
          <a href="https://qweq2.github.io/glav-menu-salats/">Главная</a>
        </div>
      </div>
      <div class="glavnoe">
        <div><a href="">Магазин</a></div>
      </div>
      <div class="glavnoe">
        <div><a href="https://qweq2.github.io/blogs-salats/">Блоги</a></div>
      </div>
      <div class="ssilky">
        <div>
          <a href=""><i class="fa-brands fa-instagram"></i></a>
        </div>
        <div>
          <a href="https://vk.com/zzzzzzzzzzzzzzzzzzaz"
            ><i class="fa-brands fa-vk"></i
          ></a>
        </div>
        <div>
          <a href=""><i class="fa-brands fa-whatsapp"></i></a>
        </div>
      </div>
    </div>

    <div class="perehody">
      <p>
        <a href="https://qweq2.github.io/glav-menu-salats/">Главная</a>-<a
          href=""
          >Магазин</a
        >
      </p>
    </div>
    <div class="salats">
      <div class="salat">
        <p class="card__title">Салат Цезарь</p>
        <img
          class="card__image"
          src="https://cake-dance.ru/wp-content/uploads/a/7/9/a7996179f30a61b2c06b79e99c019276.jpeg"
        />
        <div class="price">
          <p class="card__price--common">90p.</p>
          -100гр
        </div>
        <button class="add-card">В корзину</button>
      </div>
      <div class="salat">
        <p class="card__title">Салат Оливье</p>
        <img
          class="card__image"
          src="https://avatars.dzeninfra.ru/get-zen_doc/271828/pub_65731474cdd4553c12e4f520_6573172f2f3b6416518608c4/scale_1200"
        />
        <div class="price">
          <p class="card__price--common">80p.</p>
          -100гр
        </div>
        <button class="add-card">В корзину</button>
      </div>
      <div class="salat">
        <p class="card__title">Салат Винегрет</p>
        <img
          class="card__image"
          src="https://mykaleidoscope.ru/uploads/posts/2022-07/1656627626_39-mykaleidoscope-ru-p-salat-vinegret-yeda-krasivo-foto-42.jpg"
        />
        <div class="price">
          <p class="card__price--common">70p.</p>
          -100гр
        </div>
        <button class="add-card">В корзину</button>
      </div>
      <div class="salat">
        <p class="card__title">Салат Греческий</p>
        <img
          class="card__image"
          src="https://eda.ru/images/RecipePhoto/390x390/grecheskiy-salat_175404_photo_183111.jpg"
        />
        <div class="price">
          <p class="card__price--common">70p.</p>
          -100гр
        </div>
        <button class="add-card">В корзину</button>
      </div>
      <div class="salat">
        <p class="card__title">Салат Селедка под шубой</p>
        <img
          class="card__image"
          src="https://media.ovkuse.ru/images/recipes/486d4829-6de1-43a5-acd3-e900b6a6b759/486d4829-6de1-43a5-acd3-e900b6a6b759.jpg"
        />
        <div class="price">
          <p class="card__price--common">60p.</p>
          -100гр
        </div>
        <button class="add-card">В корзину</button>
      </div>
    </div>
    <div class="karzina">
      <button class="cart" id="cart">
        <img
          class="cart__image"
          src="https://github.com/toni-wheel/demo-shopping-cart/blob/dev/images/cart.png?raw=true"
          alt="Cart"
        />
      </button>
    </div>
    <div class="modal" id="modal">
      <div class="modal__box">
        <div class="modal__title">Корзина</div>
        <div class="modal__info"></div>
        <div class="modal__bottom">
          <a href="https://qweq2.github.io/oplata-salats/" class="oplata">Оплатить</a>
          <a href="#" class="btn btn--close" id="btn_close">Закрыть корзину</a>
        </div>
      </div>
    </div>
    <script>
      const body = document.body;
      const btn = document.querySelector(".cart");
      const btnClose = document.querySelector("#btn_close");
      const modal = document.querySelector("#modal");
      const createDiv = document.createElement("div");

      btn.addEventListener("click", btnHandler);
      btnClose.addEventListener("click", btnCloseHandler);

      function btnHandler(e) {
        e.preventDefault();
        body.classList.add("lock");
        modal.classList.add("modal--open");
      }
      function btnCloseHandler(e) {
        e.preventDefault();
        body.classList.remove("lock");
        modal.classList.remove("modal--open");
      }
      window.addEventListener("click", function (e) {
        if (e.target == modal) {
          body.classList.remove("lock");
          modal.classList.remove("modal--open");
        }
      });
      //
      //
      //
      let cart = [];
      const addToCartButtons = document.querySelectorAll(".add-card");
      addToCartButtons.forEach((button) => {
        button.addEventListener("click", addToCart);
      });
      function addToCart(event) {
        const salat = event.target.closest(".salat");
        const title = salat.querySelector(".card__title").innerText;
        const price = salat.querySelector(".card__price--common").innerText;
        const image = salat.querySelector(".card__image").src;

        const item = { title, price, image, quantity: 1 };
        cart.push(item);

        updateModalInfo();
      }
      function updateModalInfo() {
        const modalInfo = document.querySelector(".modal__info");
        modalInfo.innerHTML = "";

        if (cart.length === 0) {
          modalInfo.innerHTML = "<p>Корзина пуста</p>";
          return;
        }

        cart.forEach((item, index) => {
          const div = document.createElement("div");
          div.classList.add("cart-item");
          div.innerHTML = `
      <img src="${item.image}" alt="${item.title}" width="100">
      <div>
        <p>${item.title}</p>
        <p>${item.price}</p>
      </div>
      <div>
        <button class="remove-item" data-index="${index}">Удалить</button>
      </div>
    `;
          modalInfo.appendChild(div);
        });

        const removeButtons = document.querySelectorAll(".remove-item");
        removeButtons.forEach((button) => {
          button.addEventListener("click", removeFromCart);
        });
      }
      function removeFromCart(event) {
        const index = event.target.getAttribute("data-index");
        cart.splice(index, 1);
        updateModalInfo();
      }
      //
      //
      //
      function calculateTotalPrice() {
        let totalPrice = 0;
        cart.forEach((item) => {
          const price = parseFloat(item.price.replace("p.", ""));
          totalPrice += price * item.quantity;
        });
        return totalPrice;
      }
      function updateModalInfo() {
        const modalInfo = document.querySelector(".modal__info");
        modalInfo.innerHTML = "";

        if (cart.length === 0) {
          modalInfo.innerHTML = "<p>Корзина пуста</p>";
          return;
        }

        cart.forEach((item, index) => {
          const div = document.createElement("div");
          div.classList.add("cart-item");
          div.innerHTML = `
      <img src="${item.image}" alt="${item.title}" width="100">
      <div>
        <p>${item.title}</p>
        <p>${item.price}</p>
      </div>
      <div>
        <button class="remove-item" data-index="${index}">Удалить</button>
      </div>
    `;
          modalInfo.appendChild(div);
        });

        const totalPrice = calculateTotalPrice();
        const totalPriceDiv = document.createElement("div");
        totalPriceDiv.classList.add("total-price");
        totalPriceDiv.innerText = `Общая сумма: ${totalPrice} p.`;
        modalInfo.appendChild(totalPriceDiv);

        const removeButtons = document.querySelectorAll(".remove-item");
        removeButtons.forEach((button) => {
          button.addEventListener("click", removeFromCart);
        });
      }
    </script>
  </body>
</html>
